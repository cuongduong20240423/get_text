# 1. Cài helm
curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash

# 2. Thêm repo Jenkins
helm repo add jenkins https://charts.jenkins.io
helm repo update

# 3. Tạo namespace
kubectl create namespace devops

# 4. Cài Jenkins LTS mới nhất
helm install jenkins jenkins/jenkins \
  --namespace devops \
  --set controller.image.tag="lts-jdk11"

# 5. Xem pod
kubectl get pods -n devops
kubectl get pods -n devops -o wide   # xem đang ở VM nào

# 6. Lấy admin password
kubectl get secret jenkins -n devops -o jsonpath="{.data.jenkins-admin-password}" | base64 --decode; echo

# 7. Đổi Service sang NodePort
kubectl patch svc jenkins -n devops -p '{"spec": {"type": "NodePort"}}'

# 8. Xem port để truy cập
kubectl get svc jenkins -n devops
